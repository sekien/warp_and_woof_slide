(function(c){c.fn.WaWS=function(b){b=c.extend({warp:3,woof:3,data:[],launch:5,speed:300,spped_ajust:100,panel_size:100,auto_slide:{auto_run:!1,order:"forward",interval:1E4},view:{width:300,height:300,image_max_width:280,image_max_height:280,interval:5E3,open_url_target:"_blank",close:!0}},b);var m="#"+c(this).attr("id");0>=b.warp&&(b.warp=1);0>=b.woof&&(b.woof=1);if(b.launch>b.warp*b.woof||0>=b.launch)b.launch=1;var d=b.speed,k=b.woof*b.panel_size+"px",F=b.warp*b.panel_size+"px",D=b.launch,t,w,A=
1,q=[],x=Math.floor(2*Math.random());c(m).css({"font-size":"0",display:"inline-block","*display":"inline","*zoom":"1","letter-spacing":"-.40em",overflow:"hidden",position:"relative","text-align":"left","vertical-align":"top",padding:"0",width:k,height:F});for(var u=[],v=[],y,B={},k=0;k<b.data.length;k++)B[k]=new Image,B[k].src=b.data[k].image,C++;if(b.data.length>b.warp*b.woof){var C=0;u[C]=[];for(k=b.warp*b.woof;k<b.data.length;k++)u[C]=b.data[k],C++}var E=function(c){if(1==b.auto_slide.auto_run)var a=
setTimeout(function(){c.autoMove(a)},b.auto_slide.interval);return a},p=function(){this.aww=[];this.aww[0]=[];this.panel_cnt=b.warp*b.woof;this.base_alt=this.bgselect=this.panels="";this.p_size=b.panel_size+"px";this.n_size=-1*b.panel_size+"px";for(var h=0,a=0,f=0,e=0;e<this.panel_cnt;e++)this.panels='<p id="waws_p'+(e+1)+'" class="waws_plate"><span></span></p>',this.bgselect="#waws_p"+(e+1)+" span",c(m).append(this.panels),e<b.data.length?(c(this.bgselect).css("background-image","url("+b.data[e].image+
")"),c(this.bgselect).attr("alt",b.data[e].title)):(c(this.bgselect).css("background-image","url("+b.data[f].image+")"),c(this.bgselect).attr("alt",b.data[f].title),f++),a>b.woof-1&&(h++,this.aww[h]=[],a=0),this.aww[h][a]="waws_p"+(e+1),e==b.launch-1&&(t=h,w=a),a++;c(".waws_plate,.waws_plate span").css({width:this.p_size,height:this.p_size})};p.prototype.setPanel=function(b,a){this.slideAnimation(b,a,b<t?"d":b>t?"u":"n",a<w?"r":a>w?"l":"n")};p.prototype.slideAnimation=function(h,a,f,e){var l=[],n=
[],z=[],g,r=function(e,G,d){"u"==f?(l=[G,"0"],q=[h-1,a]):"d"==f&&(l=[e,"0"],q=[h+1,a]);for(e=0;e<b.warp;e++)g="#"+d[e][a]+" span",n[e]=c(g).css("background-image"),z[e]=c(g).attr("alt")},d=function(f,d,r){"l"==e?(l=["0",d],q=[h,a-1]):"r"==e?(l=["0",f],q=[h,a+1]):(l=["0","0"],q=[h,a]);for(f=0;f<b.woof;f++)g="#"+r[h][f]+" span",n[f]=c(g).css("background-image"),z[f]=c(g).attr("alt")};0==x?"n"!=f?r(this.p_size,this.n_size,this.aww):d(this.p_size,this.n_size,this.aww):"n"!=e?d(this.p_size,this.n_size,
this.aww):r(this.p_size,this.n_size,this.aww);v.hasOwnProperty("image")&&u.shift();this.setDummySpan(h,a,f,e);this.slideAnimation2(n,z,l,h,a,f,e)};p.prototype.setDummySpan=function(h,a,f,e){var l,n,d="",g=function(h,e,g){l="#"+g[0][a]+" span";n="#"+g[b.warp-1][a]+" span";"u"==f?(d=c(l).css("background-image"),c(n).after(function(){return'<span id="WaWS_dummy"></span>'}),c("#WaWS_dummy").css("top",h)):"d"==f&&(d=c(n).css("background-image"),c(l).before(function(){return'<span id="WaWS_dummy"></span>'}),
c("#WaWS_dummy").css("top",e))},r=function(a,f,g){l="#"+g[h][0]+" span";n="#"+g[h][b.woof-1]+" span";"l"==e?(d=c(l).css("background-image"),c(n).after(function(){return'<span id="WaWS_dummy"></span>'}),c("#WaWS_dummy").css("left",a)):"r"==e&&(d=c(n).css("background-image"),c(l).before(function(){return'<span id="WaWS_dummy"></span>'}),c("#WaWS_dummy").css("left",f))};0==x?"n"!=f?g(this.p_size,this.n_size,this.aww):r(this.p_size,this.n_size,this.aww):"n"!=e?r(this.p_size,this.n_size,this.aww):g(this.p_size,
this.n_size,this.aww);null!=u[0]&&(d="url("+u[0].image+")");c("#WaWS_dummy").css({"background-image":d,width:this.p_size,height:this.p_size})};p.prototype.slideAnimation2=function(h,a,f,e,l,n,z){var g="",r={transform:"none","-webkit-transform":"none","-moz-transform":"none","-o-transform":"none","-ms-transform":"none","-transition":"0","-webkit-transition":"0","-moz-transition":"0","-o-transition":"0","-ms-transition":"0",left:"0px",top:"0px"},k=function(k){for(var m=0;m<b.warp;m++)g="#"+k[m][l]+
", +span ,+#WaWS_dummy",c(g).css({transform:"translateY("+f[0]+")","-webkit-transform":"translateY("+f[0]+")","-moz-transform":"translateY("+f[0]+")","-o-transform":"translateY("+f[0]+")","-ms-transform":"translateY("+f[0]+")",transition:d+"ms","-webkit-transition":d+"ms","-moz-transition":d+"ms","-o-transition":d+"ms","-ms-transition":d+"ms"}).one("webkitTransitionEnd transitionend oTransitionEnd msTransitionEnd",function(){c(this).css(r);p.prototype.setSlidePanelvalue(h,a,e,l,n,z,k)})},m=function(m){for(var k=
0;k<b.woof;k++)g="#"+m[e][k]+", +span ,+#WaWS_dummy",c(g).css({transform:"translateX("+f[1]+")","-webkit-transform":"translateX("+f[1]+")","-moz-transform":"translateX("+f[1]+")","-o-transform":"translateX("+f[1]+")","-ms-transform":"translateX("+f[1]+")",transition:d+"ms","-webkit-transition":d+"ms","-moz-transition":d+"ms","-o-transition":d+"ms","-ms-transition":d+"ms"}).one("webkitTransitionEnd transitionend oTransitionEnd msTransitionEnd",function(){c(this).css(r);p.prototype.setSlidePanelvalue(h,
a,e,l,n,z,m)})};0==x?"0"!=f[0]?k(this.aww):m(this.aww):"0"!=f[1]?m(this.aww):k(this.aww);this.checkPanelPosition()};p.prototype.setSlidePanelvalue=function(h,a,f,e,l,n,d){var g="",k="";c("#WaWS_dummy").remove();var m=function(b){var a=[];if(null!=u[0])a.image=c(b).css("background-image"),a.title=c(b).attr("alt"),c(b).css("background-image","url("+u[0].image+")"),c(b).attr("alt",u[0].title);else return!1;return a},p=function(f){var d=[];if("u"==l){for(d=0;d<b.warp;d++)g="#"+f[d][e]+" span",c(g).css("background-image",
h[d+1]),c(g).attr("alt",a[d+1]);c(g).css("background-image",h[0]);c(g).attr("alt",a[0]);d=m(g)}else if("d"==l){for(d=0;d<b.warp;d++)g="#"+f[d][e]+" span",0==d?(c(g).css("background-image",h[h.length-1]),c(g).attr("alt",a[a.length-1])):(c(g).css("background-image",h[d-1]),c(g).attr("alt",a[d-1]));k="#"+f[0][e]+" span";d=m(k)}return d},q=function(d){var e=[];if("l"==n){for(e=0;e<b.woof;e++)g="#"+d[f][e]+" span",c(g).css("background-image",h[e+1]),c(g).attr("alt",a[e+1]);c(g).css("background-image",
h[0]);c(g).attr("alt",a[0]);e=m(g)}else if("r"==n){for(e=0;e<b.woof;e++)g="#"+d[f][e]+" span",0==e?(c(g).css("background-image",h[h.length-1]),c(g).attr("alt",a[a.length-1])):(c(g).css("background-image",h[e-1]),c(g).attr("alt",a[e-1]));k="#"+d[f][0]+" span";e=m(k)}return e},t=[];v=t=0==x?"n"!=l?p(d):q(d):"n"!=n?q(d):p(d)};p.prototype.checkPanelPosition=function(){var c=this.base_alt;y=this;if(q[0]==t&&q[1]==w)var a=setTimeout(function(){y.openLargeWindow(a)},d+b.spped_ajust);else setTimeout(function(){y.reserveDataPush(c);
x=0==x?1:0;y.setPanel(q[0],q[1])},d+b.spped_ajust)};p.prototype.reserveDataPush=function(){if(v.image){v.image=v.image.replace("url(","");v.image=v.image.replace(")","");for(var c=this.base_alt,a=0,f=0,e=b.data.length;f<e;f++)if(f in b.data&&b.data[f].title===c){a=f;break}}else return!1;u.push({image:v.image,url:b.data[a].url,title:v.title})};p.prototype.openLargeWindow=function(h){clearTimeout(h);this.reserveDataPush();h=this.base_alt;var a=0;y=this;for(var f=0,e=b.data.length;f<e;f++)if(f in b.data&&
b.data[f].title===h){a=f;break}c(m).after('<p id="WaWSlargeview"><span></span></p>');var l=c(m).offset();c("#WaWSlargeview").css({left:l.left+c(m).width()/2+"px",top:l.top+c(m).height()/2+"px"});B[a].src=b.data[a].image;var n=B[a].width,k=B[a].height,g;h=n>k?b.view.image_max_width+"px auto":"auto "+b.view.image_max_height+"px";c("#WaWSlargeview span").css("background-size",h);c("#WaWSlargeview span").attr("title",b.data[a].title);c("#WaWSlargeview").show().animate({left:l.left+c(m).width()/2-b.view.width/
2+"px",top:l.top+c(m).height()/2-b.view.height/2-16+"px",width:b.view.width,height:b.view.height},d,function(){1==b.view.close&&c("#WaWSlargeview").append('<div id="WaWSclose"></div>');c("#WaWSlargeview span").css({"background-image":"url("+b.data[a].image+")",width:n+"px",height:k+"px","vertical-align":"middle","margin-top":(b.view.height-b.view.image_max_height)/2+"px","margin-left":"auto","margin-right":"auto","max-width":b.view.image_max_width+"px","max-height":b.view.image_max_height+"px"});
c("#WaWSclose").css({left:b.view.width-c("#WaWSclose").width()+"px"})});var p=function(){c("#WaWSlargeview span,#WaWSclose").remove();c.when(c("#WaWSlargeview").animate({opacity:"hide",left:l.left+c(m).width()/2+"px",top:l.top+c(m).height()/2+"px",width:"1px",height:"1px"},d)).done(function(){c("#WaWSlargeview").remove();clearTimeout(g);g=null;A=1;E(y)})};(function(){g=setTimeout(function(){p()},b.view.interval)})();c("#WaWSlargeview span").on("click",function(){""==b.data[a].url?g&&p():window.open(b.data[a].url,
b.view.open_url_target)});c(document).on("click","#WaWSclose",function(){g&&p()})};p.prototype.autoMove=function(d){clearTimeout(d);A=0;var a=[];d=function(a){for(var c=[],d=0;d<b.warp;d++)for(var h=0;h<b.woof;h++)if(d in this.aww&&this.aww[d][h]===a){c[0]=d;c[1]=h;break}return c};"forward"==b.auto_slide.order?(a="waws_p"+(D-1),c("#"+a)[0]?console.log("find:"+a):(console.log("none:"+a),a="waws_p"+this.panel_cnt,console.log("newid:"+a)),a=d(a)):"back"==b.auto_slide.order?(a="waws_p"+(D+1),c("#"+a)[0]?
console.log("find:"+a):(console.log("none:"+a),a="waws_p1",console.log("newid:"+a)),a=d(a)):(a[0]=Math.floor(Math.random()*b.warp),a[1]=Math.floor(Math.random()*b.woof),a[0]==t&&a[1]==w&&(a=0!=a[0]&&0!=a[1]?[0,0]:[b.warp-1,b.woof-1]));this.base_alt=c("#"+this.aww[a[0]][a[1]]+" span").attr("alt");a[0]==t&&a[1]==w?this.openLargeWindow():this.setPanel(a[0],a[1])};this.each(function(){var d=new p;c(".waws_plate").bind("click",function(){if(1==A){A=0;var a=c(this).attr("id");d.base_alt=c("#"+a+" span").attr("alt");
for(var e,l,k=0;k<b.warp&&!(e=k,l=d.aww[k].lastIndexOf(a),-1<l);k++);e==t&&l==w?d.openLargeWindow():d.setPanel(e,l)}});var a;1==A&&(a=E(d));c("#WaWSstopAutoRun").click(function(){a&&(clearTimeout(a),b.auto_slide.auto_run=!1,console.log("stop auto-run"))})});return this}})(jQuery);