(function(b){b.fn.WaWS=function(a){a=b.extend({warp:3,woof:3,data:[],launch:5,speed:300,spped_ajust:100,panel_size:100,auto_slide:{auto_run:!1,order:"forward",interval:1E4},view:{width:300,height:300,image_max_width:280,image_max_height:280,interval:5E3,open_url_target:"_blank",close:!0}},a);var t="#"+b(this).attr("id");0>=a.warp&&(a.warp=1);0>=a.woof&&(a.woof=1);if(a.launch>a.warp*a.woof||0>=a.launch)a.launch=1;a.auto_slide.auto_run||(a.auto_slide.auto_run=!1);a.auto_slide.order||(a.auto_slide.order=
"forward");a.auto_slide.interval||(a.auto_slide.interval=1E4);a.view.width||(a.view.width=300);a.view.height||(a.view.width=300);a.view.image_max_width||(a.view.image_max_width=280);a.view.image_max_height||(a.view.image_max_height=280);a.view.interval||(a.view.interval=5E3);a.view.open_url_target||(a.view.open_url_target="_blank");a.view.close||(a.view.close=!0);var d=a.speed,q=a.woof*a.panel_size+"px",G=a.warp*a.panel_size+"px",E=a.launch,u,x,B=1,k=[],y=Math.floor(2*Math.random());b(t).css({"font-size":"0",
display:"inline-block","*display":"inline","*zoom":"1","letter-spacing":"-.40em",overflow:"hidden",position:"relative","text-align":"left","vertical-align":"top",padding:"0",width:q,height:G});for(var v=[],w=[],z,C={},q=0;q<a.data.length;q++)C[q]=new Image,C[q].src=a.data[q].image,D++;if(a.data.length>a.warp*a.woof){var D=0;v[D]=[];for(q=a.warp*a.woof;q<a.data.length;q++)v[D]=a.data[q],D++}var F=function(b){if(1==a.auto_slide.auto_run)var c=setTimeout(function(){b.autoMove(c)},a.auto_slide.interval);
return c},m=function(){this.aww=[];this.aww[0]=[];this.panel_cnt=a.warp*a.woof;this.base_alt=this.bgselect=this.panels="";this.p_size=a.panel_size+"px";this.n_size=-1*a.panel_size+"px";for(var h=0,c=0,e=0,f=0;f<this.panel_cnt;f++)this.panels='<p id="waws_p'+(f+1)+'" class="waws_plate"><span></span></p>',this.bgselect="#waws_p"+(f+1)+" span",b(t).append(this.panels),f<a.data.length?(b(this.bgselect).css("background-image","url("+a.data[f].image+")"),b(this.bgselect).attr("alt",a.data[f].title)):(b(this.bgselect).css("background-image",
"url("+a.data[e].image+")"),b(this.bgselect).attr("alt",a.data[e].title),e++),c>a.woof-1&&(h++,this.aww[h]=[],c=0),this.aww[h][c]="waws_p"+(f+1),f==a.launch-1&&(u=h,x=c),c++;b(".waws_plate,.waws_plate span").css({width:this.p_size,height:this.p_size})};m.prototype.setPanel=function(a,b){this.slideAnimation(a,b,a<u?"d":a>u?"u":"n",b<x?"r":b>x?"l":"n")};m.prototype.slideAnimation=function(h,c,e,f){var n=[],l=[],A=[],g,d=function(f,d,p){"u"==e?(n=[d,"0"],k=[h-1,c]):"d"==e&&(n=[f,"0"],k=[h+1,c]);for(f=
0;f<a.warp;f++)g="#"+p[f][c]+" span",l[f]=b(g).css("background-image"),A[f]=b(g).attr("alt")},p=function(e,d,p){"l"==f?(n=["0",d],k=[h,c-1]):"r"==f?(n=["0",e],k=[h,c+1]):(n=["0","0"],k=[h,c]);for(e=0;e<a.woof;e++)g="#"+p[h][e]+" span",l[e]=b(g).css("background-image"),A[e]=b(g).attr("alt")};0==y?"n"!=e?d(this.p_size,this.n_size,this.aww):p(this.p_size,this.n_size,this.aww):"n"!=f?p(this.p_size,this.n_size,this.aww):d(this.p_size,this.n_size,this.aww);w.hasOwnProperty("image")&&v.shift();this.setDummySpan(h,
c,e,f);this.slideAnimation2(l,A,n,h,c,e,f)};m.prototype.setDummySpan=function(h,c,e,f){var n,l,d="",g=function(h,f,g){n="#"+g[0][c]+" span";l="#"+g[a.warp-1][c]+" span";"u"==e?(d=b(n).css("background-image"),b(l).after(function(){return'<span id="WaWS_dummy"></span>'}),b("#WaWS_dummy").css("top",h)):"d"==e&&(d=b(l).css("background-image"),b(n).before(function(){return'<span id="WaWS_dummy"></span>'}),b("#WaWS_dummy").css("top",f))},m=function(c,e,g){n="#"+g[h][0]+" span";l="#"+g[h][a.woof-1]+" span";
"l"==f?(d=b(n).css("background-image"),b(l).after(function(){return'<span id="WaWS_dummy"></span>'}),b("#WaWS_dummy").css("left",c)):"r"==f&&(d=b(l).css("background-image"),b(n).before(function(){return'<span id="WaWS_dummy"></span>'}),b("#WaWS_dummy").css("left",e))};0==y?"n"!=e?g(this.p_size,this.n_size,this.aww):m(this.p_size,this.n_size,this.aww):"n"!=f?m(this.p_size,this.n_size,this.aww):g(this.p_size,this.n_size,this.aww);null!=v[0]&&(d="url("+v[0].image+")");b("#WaWS_dummy").css({"background-image":d,
width:this.p_size,height:this.p_size})};m.prototype.slideAnimation2=function(h,c,e,f,n,l,A){var g="",q={"-webkit-transform":"none","-moz-transform":"none","-o-transform":"none","-ms-transform":"none",transform:"none","-webkit-transition":"0ms","-moz-transition":"0ms","-o-transition":"0ms","-ms-transition":"0ms","-transition":"0ms",left:"0px",top:"0px"},p=function(p){for(var k=0;k<a.warp;k++)g="#"+p[k][n]+", +span ,+#WaWS_dummy",b(g).css({"-webkit-transform":"translateY("+e[0]+")","-moz-transform":"translateY("+
e[0]+")","-o-transform":"translateY("+e[0]+")","-ms-transform":"translateY("+e[0]+")",transform:"translateY("+e[0]+")","-webkit-transition":d+"ms","-moz-transition":d+"ms","-o-transition":d+"ms","-ms-transition":d+"ms",transition:d+"ms"}).one("webkitTransitionEnd transitionend oTransitionEnd msTransitionEnd",function(){b(this).css(q);m.prototype.setSlidePanelvalue(h,c,f,n,l,A,p)})},k=function(p){for(var k=0;k<a.woof;k++)g="#"+p[f][k]+", +span ,+#WaWS_dummy",b(g).css({"-webkit-transform":"translateX("+
e[1]+")","-moz-transform":"translateX("+e[1]+")","-o-transform":"translateX("+e[1]+")","-ms-transform":"translateX("+e[1]+")",transform:"translateX("+e[1]+")","-webkit-transition":d+"ms","-moz-transition":d+"ms","-o-transition":d+"ms","-ms-transition":d+"ms",transition:d+"ms"}).one("webkitTransitionEnd transitionend oTransitionEnd msTransitionEnd",function(){b(this).css(q);m.prototype.setSlidePanelvalue(h,c,f,n,l,A,p)})};0==y?"0"!=e[0]?p(this.aww):k(this.aww):"0"!=e[1]?k(this.aww):p(this.aww);this.checkPanelPosition()};
m.prototype.setSlidePanelvalue=function(h,c,e,f,d,l,k){var g="",m="";b("#WaWS_dummy").remove();var p=function(a){var c=[];if(null!=v[0])c.image=b(a).css("background-image"),c.title=b(a).attr("alt"),b(a).css("background-image","url("+v[0].image+")"),b(a).attr("alt",v[0].title);else return!1;return c},q=function(e){var r=[];if("u"==d){for(r=0;r<a.warp;r++)g="#"+e[r][f]+" span",b(g).css("background-image",h[r+1]),b(g).attr("alt",c[r+1]);b(g).css("background-image",h[0]);b(g).attr("alt",c[0]);r=p(g)}else if("d"==
d){for(r=0;r<a.warp;r++)g="#"+e[r][f]+" span",0==r?(b(g).css("background-image",h[h.length-1]),b(g).attr("alt",c[c.length-1])):(b(g).css("background-image",h[r-1]),b(g).attr("alt",c[r-1]));m="#"+e[0][f]+" span";r=p(m)}return r},t=function(f){var d=[];if("l"==l){for(d=0;d<a.woof;d++)g="#"+f[e][d]+" span",b(g).css("background-image",h[d+1]),b(g).attr("alt",c[d+1]);b(g).css("background-image",h[0]);b(g).attr("alt",c[0]);d=p(g)}else if("r"==l){for(d=0;d<a.woof;d++)g="#"+f[e][d]+" span",0==d?(b(g).css("background-image",
h[h.length-1]),b(g).attr("alt",c[c.length-1])):(b(g).css("background-image",h[d-1]),b(g).attr("alt",c[d-1]));m="#"+f[e][0]+" span";d=p(m)}return d},u=[];w=u=0==y?"n"!=d?q(k):t(k):"n"!=l?t(k):q(k)};m.prototype.checkPanelPosition=function(){var b=this.base_alt;z=this;if(k[0]==u&&k[1]==x)var c=setTimeout(function(){z.openLargeWindow(c)},d+a.spped_ajust);else setTimeout(function(){z.reserveDataPush(b);y=0==y?1:0;z.setPanel(k[0],k[1])},d+a.spped_ajust)};m.prototype.reserveDataPush=function(){if(w.image){w.image=
w.image.replace("url(","");w.image=w.image.replace(")","");for(var b=this.base_alt,c=0,e=0,d=a.data.length;e<d;e++)if(e in a.data&&a.data[e].title===b){c=e;break}}else return!1;v.push({image:w.image,url:a.data[c].url,title:w.title})};m.prototype.openLargeWindow=function(h){clearTimeout(h);this.reserveDataPush();h=this.base_alt;var c=0;z=this;for(var e=0,f=a.data.length;e<f;e++)if(e in a.data&&a.data[e].title===h){c=e;break}b(t).after('<p id="WaWSlargeview"><span></span></p>');h=b(t).offset();b("#WaWSlargeview").css({left:h.left+
b(t).width()/2+"px",top:h.top+b(t).height()/2+"px"});C[c].src=a.data[c].image;var n=C[c].width,l=C[c].height,k,e=n>l?a.view.image_max_width+"px auto":"auto "+a.view.image_max_height+"px";b("#WaWSlargeview span").css("background-size",e);b("#WaWSlargeview span").attr("title",a.data[c].title);b("#WaWSlargeview").show().css({border:"1px solid #000",left:h.left+b(t).width()/2-a.view.width/2+"px",top:h.top+b(t).height()/2-a.view.height/2-16+"px",width:a.view.width,height:a.view.height,"-webkit-transition-property":"width,height",
"-moz-transition-property":"width,height","-o-transition-property":"width,height","-ms-transition-property":"width,height","transition-property":"width,height","-webkit-transition":d+"ms","-moz-transition":d+"ms","-o-transition":d+"ms","-ms-transition":d+"ms",transition:d+"ms"}).one("webkitTransitionEnd transitionend oTransitionEnd msTransitionEnd",function(){1!=a.view.close||b("#WaWSclose")[0]||b("#WaWSlargeview").append('<div id="WaWSclose"></div>');b("#WaWSlargeview span").css({"background-image":"url("+
a.data[c].image+")",width:n+"px",height:l+"px","vertical-align":"middle","margin-top":(a.view.height-a.view.image_max_height)/2+"px","margin-left":"auto","margin-right":"auto","max-width":a.view.image_max_width+"px","max-height":a.view.image_max_height+"px"});b("#WaWSclose").css({left:a.view.width-b("#WaWSclose").width()+"px"})});var g=function(){b("#WaWSlargeview span,#WaWSclose").remove();b("#WaWSlargeview").css({opacity:"0","-webkit-transform":"scale(0.1)","-moz-transform":"scale(0.1)","-o-transform":"scale(0.1)",
"-ms-transform":"scale(0.1)",transform:"scale(0.1)","-webkit-transition":d+"ms","-moz-transition":d+"ms","-o-transition":d+"ms","-ms-transition":d+"ms",transition:d+"ms"}).one("webkitTransitionEnd transitionend oTransitionEnd msTransitionEnd",function(){b("#WaWSlargeview").remove();clearTimeout(k);k=null;B=1;F(z)})};(function(){k=setTimeout(function(){g()},a.view.interval)})();b("#WaWSlargeview span").on("click",function(){""==a.data[c].url?k&&g():window.open(a.data[c].url,a.view.open_url_target)});
b(document).on("click","#WaWSclose",function(){k&&g()})};m.prototype.autoMove=function(d){clearTimeout(d);B=0;var c=[];d=function(b){for(var c=[],d=0;d<a.warp;d++)for(var h=0;h<a.woof;h++)if(d in this.aww&&this.aww[d][h]===b){c[0]=d;c[1]=h;break}return c};"forward"==a.auto_slide.order?(c="waws_p"+(E-1),b("#"+c)[0]||(c="waws_p"+this.panel_cnt),c=d(c)):"back"==a.auto_slide.order?(c="waws_p"+(E+1),b("#"+c)[0]||(c="waws_p1"),c=d(c)):(c[0]=Math.floor(Math.random()*a.warp),c[1]=Math.floor(Math.random()*
a.woof),c[0]==u&&c[1]==x&&(c=0!=c[0]&&0!=c[1]?[0,0]:[a.warp-1,a.woof-1]));this.base_alt=b("#"+this.aww[c[0]][c[1]]+" span").attr("alt");c[0]==u&&c[1]==x?this.openLargeWindow():this.setPanel(c[0],c[1])};this.each(function(){var d=new m;b(".waws_plate").bind("click",function(){if(1==B){B=0;var c=b(this).attr("id");d.base_alt=b("#"+c+" span").attr("alt");for(var f,k,l=0;l<a.warp&&!(f=l,k=d.aww[l].lastIndexOf(c),-1<k);l++);f==u&&k==x?d.openLargeWindow():d.setPanel(f,k)}});var c;1==B&&(c=F(d));b("#WaWSstopAutoRun").click(function(){c&&
(clearTimeout(c),a.auto_slide.auto_run=!1,console.log("stop auto-run"))})});return this}})(jQuery);